{"log_id": "c385c603-1076-4f5e-a27f-3b2d539b9e7a", "timestamp": "2025-07-05T02:50:32.534453+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "fb7317b0-8795-4d54-895d-b931441d6754", "timestamp": "2025-07-05T02:50:32.558302+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "6d6ea284-8112-4f96-b0ff-6c1609ac00ea", "timestamp": "2025-07-05T02:50:32.564307+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "38b85ca0-ae80-491e-ad6c-af9627ffa4cb", "timestamp": "2025-07-05T02:50:38.992937+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA сервис остановлен", "extra_data": {"source_file": "api.py", "source_function": "shutdown_event", "source_line": 66}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "e0cebb16-101e-4071-b44e-bb71fd128470", "timestamp": "2025-07-05T02:50:38.994217+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA микросервис останавливается", "extra_data": {"source_file": "main.py", "source_function": "shutdown_event", "source_line": 70}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "41775319-ddb2-402f-83b7-9deb31c38355", "timestamp": "2025-07-05T02:51:06.762398+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "d9705e2e-16c8-449b-b7f5-60cc1cc252c2", "timestamp": "2025-07-05T02:51:06.785285+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "eceb3405-d0b5-4476-b1ec-98c907678bf8", "timestamp": "2025-07-05T02:51:06.785285+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "a1921e9d-ec8d-480d-8e29-5266a18d67c3", "timestamp": "2025-07-05T02:56:06.943843+05:00", "level": "INFO", "section": "2fa", "subsection": "request_expired", "message": "Очищено 4 истекших 2FA запросов", "extra_data": {"source_file": "telegram_bot.py", "source_function": "cleanup_expired_requests", "source_line": 290}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "6249a9b2-9a18-4443-841d-7892030dacd9", "timestamp": "2025-07-05T03:01:36.335945+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA сервис остановлен", "extra_data": {"source_file": "api.py", "source_function": "shutdown_event", "source_line": 66}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "a81bbc31-ccda-418e-a938-27dbf5a6c761", "timestamp": "2025-07-05T03:01:36.335945+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA микросервис останавливается", "extra_data": {"source_file": "main.py", "source_function": "shutdown_event", "source_line": 70}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "4b016c91-c0fc-4283-b5ea-f439c8f1866c", "timestamp": "2025-07-05T03:01:41.892331+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "7fd0c1af-fa1b-49bb-8acd-c2974b95e077", "timestamp": "2025-07-05T03:01:41.930871+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "2879613c-93e4-4d1b-a87e-36003b77cb20", "timestamp": "2025-07-05T03:01:41.930871+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "9b9b6ee2-b694-4bf9-bf72-71d67ef9734f", "timestamp": "2025-07-05T03:04:06.475783+05:00", "level": "INFO", "section": "api", "subsection": "request", "message": "Получен запрос на отправку 2FA для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 110}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "6278b136-d0c2-4eda-958f-573cef7ed75b", "timestamp": "2025-07-05T03:04:06.652804+05:00", "level": "INFO", "section": "2fa", "subsection": "request_sent", "message": "Администратор Омар Амир Арманулы (amiromar.1337@gmail.com) пытается войти в систему с IP 104.28.209.143 - запускаем двухфакторную проверку через Telegram", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 72}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "65d15ef4-a746-4a49-b061-fbf381a0dc8d", "timestamp": "2025-07-05T03:04:06.652804+05:00", "level": "DEBUG", "section": "2fa", "subsection": "request_sent", "message": "Создаем временную запись 2FA для Омар Амир Арманулы - срок действия 5 минут (до 22:09:06)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 81}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "fff5a82b-87df-4ba2-9ae4-556e888a8fc5", "timestamp": "2025-07-05T03:04:06.693852+05:00", "level": "DEBUG", "section": "security", "subsection": "audit", "message": "Ищем откуда подключается пользователь - отправляем запрос геолокации для IP 104.28.209.143", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 31}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "1caad1f1-7dcb-48fa-acea-ee7ac6034776", "timestamp": "2025-07-05T03:04:07.047244+05:00", "level": "INFO", "section": "security", "subsection": "audit", "message": "Геолокация найдена: IP 104.28.209.143 находится в стране Kazakhstan, город Astana, провайдер Cloudflare, Inc.", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 42}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "9228f1ea-dc97-48b4-9934-c6c7d82cfb87", "timestamp": "2025-07-05T03:04:07.397637+05:00", "level": "INFO", "section": "telegram", "subsection": "message_sent", "message": "Уведомление о входе отправлено администратору Омар Амир Арманулы в Telegram (ID: 1172203971) - ожидаем решение о предоставлении доступа с IP 104.28.209.143 (Kazakhstan, Astana)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 127}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "eb8ca277-7329-4af4-99a0-a7a6ebe4af69", "timestamp": "2025-07-05T03:04:07.397637+05:00", "level": "INFO", "section": "api", "subsection": "response", "message": "2FA запрос успешно отправлен для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 170}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "af75d104-a5c9-4bcc-92f9-ae0a6ce86c59", "timestamp": "2025-07-05T03:07:01.445498+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA сервис остановлен", "extra_data": {"source_file": "api.py", "source_function": "shutdown_event", "source_line": 66}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "e8029aaf-a34f-4a20-8a92-c5be60ef013c", "timestamp": "2025-07-05T03:07:01.445498+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA микросервис останавливается", "extra_data": {"source_file": "main.py", "source_function": "shutdown_event", "source_line": 70}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "75c35f1e-fd8e-44b0-9b4e-1f8fbb4a1169", "timestamp": "2025-07-05T03:07:11.033107+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "7a3490f6-1bed-4298-8e2d-2c1aa0bc3452", "timestamp": "2025-07-05T03:07:11.081267+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "849bc4a3-81d8-4787-9d35-177085d7c255", "timestamp": "2025-07-05T03:07:11.082266+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "c3a6fb26-9076-4b38-b965-162071a13a60", "timestamp": "2025-07-05T03:07:11.082266+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запускаем Telegram бота для 2FA", "extra_data": {"source_file": "main.py", "source_function": "start_telegram_bot", "source_line": 23}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "ca9d51cb-f33e-43e9-98df-ee87892c791e", "timestamp": "2025-07-05T03:07:11.492143+05:00", "level": "INFO", "section": "telegram", "subsection": "callback_received", "message": "Пользователь Soldenz (@polnokrasoti) нажал кнопку в Telegram - получаем его решение по 2FA запросу", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 166}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "d257a7a4-f168-4df7-a78b-ec17bf5ace4f", "timestamp": "2025-07-05T03:07:11.678047+05:00", "level": "INFO", "section": "2fa", "subsection": "request_allowed", "message": "Администратор Soldenz РАЗРЕШИЛ вход в систему с IP 104.28.209.143 - предоставляем полный доступ к админ-панели", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 198}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "b5ff85f4-36d1-4e31-9882-b6c7f37f79e1", "timestamp": "2025-07-05T03:07:12.139214+05:00", "level": "ERROR", "section": "system", "subsection": "general", "message": "Cause exception while process update id=615463613 by bot id=7666643669\nAttributeError: type object 'TELEGRAM' has no attribute 'CALLBACK_FAILED'", "extra_data": {"module": "aiogram.event"}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "1c08688c-6974-4657-a678-ff68b4af197d", "timestamp": "2025-07-05T03:07:17.281778+05:00", "level": "INFO", "section": "telegram", "subsection": "callback_received", "message": "Пользователь Soldenz (@polnokrasoti) нажал кнопку в Telegram - получаем его решение по 2FA запросу", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 166}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "49c9a66a-8e6d-4ca0-b7c2-345605360f65", "timestamp": "2025-07-05T03:07:17.323889+05:00", "level": "WARNING", "section": "2fa", "subsection": "request_expired", "message": "Пользователь Soldenz попытался ответить на 2FA запрос, но активный запрос не найден - либо время истекло, либо запрос уже обработан (текущее время: 22:07:17)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 185}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "1a5d8b33-d486-4e41-9e4f-c45f8749ed2b", "timestamp": "2025-07-05T03:11:08.566343+05:00", "level": "INFO", "section": "api", "subsection": "request", "message": "Получен запрос на отправку 2FA для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 110}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "7935188d-e546-4ec0-af4d-0cc1ad0e8357", "timestamp": "2025-07-05T03:11:08.588913+05:00", "level": "INFO", "section": "2fa", "subsection": "request_sent", "message": "Администратор Омар Амир Арманулы (amiromar.1337@gmail.com) пытается войти в систему с IP 85.117.125.216 - запускаем двухфакторную проверку через Telegram", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 72}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "5f79ad86-6f94-4f50-82f0-45e60c6215f3", "timestamp": "2025-07-05T03:11:08.588913+05:00", "level": "DEBUG", "section": "2fa", "subsection": "request_sent", "message": "Создаем временную запись 2FA для Омар Амир Арманулы - срок действия 5 минут (до 22:16:08)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 81}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "653136b9-d38a-4282-8f13-9f879d294462", "timestamp": "2025-07-05T03:11:08.616765+05:00", "level": "DEBUG", "section": "security", "subsection": "audit", "message": "Ищем откуда подключается пользователь - отправляем запрос геолокации для IP 85.117.125.216", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 31}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "3fa0fef5-15f3-4f27-a875-1226ce7a77f2", "timestamp": "2025-07-05T03:11:09.028009+05:00", "level": "INFO", "section": "security", "subsection": "audit", "message": "Геолокация найдена: IP 85.117.125.216 находится в стране Kazakhstan, город Astana, провайдер JSC \"ALTEL\"", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 42}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "80b16d40-a7e6-4ffc-8b85-c32f547051b9", "timestamp": "2025-07-05T03:11:09.382835+05:00", "level": "INFO", "section": "telegram", "subsection": "message_sent", "message": "Уведомление о входе отправлено администратору Омар Амир Арманулы в Telegram (ID: 1172203971) - ожидаем решение о предоставлении доступа с IP 85.117.125.216 (Kazakhstan, Astana)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 128}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "af403c59-5da1-44ba-bf51-716cc3bf5c0a", "timestamp": "2025-07-05T03:11:09.382835+05:00", "level": "INFO", "section": "api", "subsection": "response", "message": "2FA запрос успешно отправлен для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 170}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "9548844d-e080-4729-8ead-01868e6a8249", "timestamp": "2025-07-05T03:11:13.780082+05:00", "level": "INFO", "section": "telegram", "subsection": "callback_received", "message": "Пользователь Soldenz (@polnokrasoti) нажал кнопку в Telegram - получаем его решение по 2FA запросу", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 166}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "f84796b4-096a-494f-bf46-7b8008400aef", "timestamp": "2025-07-05T03:11:13.816914+05:00", "level": "WARNING", "section": "2fa", "subsection": "request_denied", "message": "Администратор Soldenz ОТКЛОНИЛ попытку входа с IP 85.117.125.216 - блокируем доступ к системе", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 242}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "45059af3-1609-4d98-9038-d70b9c012e79", "timestamp": "2025-07-05T03:11:14.162089+05:00", "level": "WARNING", "section": "security", "subsection": "audit", "message": "Безопасность: Попытка входа с IP 85.117.125.216 ЗАБЛОКИРОВАНА! Администратор Soldenz сам отклонил доступ в 22:11:13 - подозрительная активность или несанкционированная попытка входа", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 260}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "dcde6c13-cd33-43cc-b241-55c5e6251533", "timestamp": "2025-07-05T03:11:20.941979+05:00", "level": "INFO", "section": "api", "subsection": "request", "message": "Получен запрос на отправку 2FA для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 110}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "5287ef0a-b347-4317-9b91-251e14fe8669", "timestamp": "2025-07-05T03:11:20.967847+05:00", "level": "INFO", "section": "2fa", "subsection": "request_sent", "message": "Администратор Омар Амир Арманулы (amiromar.1337@gmail.com) пытается войти в систему с IP 85.117.125.216 - запускаем двухфакторную проверку через Telegram", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 72}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "30c30846-43dc-4284-8657-3a08bfe955e6", "timestamp": "2025-07-05T03:11:20.968596+05:00", "level": "DEBUG", "section": "2fa", "subsection": "request_sent", "message": "Создаем временную запись 2FA для Омар Амир Арманулы - срок действия 5 минут (до 22:16:20)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 81}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "2980b236-f612-4b9e-980c-885995531698", "timestamp": "2025-07-05T03:11:20.994838+05:00", "level": "DEBUG", "section": "security", "subsection": "audit", "message": "Ищем откуда подключается пользователь - отправляем запрос геолокации для IP 85.117.125.216", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 31}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "d3700d88-ca79-478c-9e37-1847a1c9f75e", "timestamp": "2025-07-05T03:11:21.324733+05:00", "level": "INFO", "section": "security", "subsection": "audit", "message": "Геолокация найдена: IP 85.117.125.216 находится в стране Kazakhstan, город Astana, провайдер JSC \"ALTEL\"", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 42}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "9ce5255d-3a82-429b-8577-bfdfe4fcc663", "timestamp": "2025-07-05T03:11:21.435643+05:00", "level": "INFO", "section": "telegram", "subsection": "message_sent", "message": "Уведомление о входе отправлено администратору Омар Амир Арманулы в Telegram (ID: 1172203971) - ожидаем решение о предоставлении доступа с IP 85.117.125.216 (Kazakhstan, Astana)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 128}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "c9ad5284-21dd-4e8f-812e-73e59160aa2b", "timestamp": "2025-07-05T03:11:21.435643+05:00", "level": "INFO", "section": "api", "subsection": "response", "message": "2FA запрос успешно отправлен для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 170}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "dbdb0ba5-bfc4-4e90-b9b7-02c4fa6c8d1e", "timestamp": "2025-07-05T03:11:24.979456+05:00", "level": "INFO", "section": "telegram", "subsection": "callback_received", "message": "Пользователь Soldenz (@polnokrasoti) нажал кнопку в Telegram - получаем его решение по 2FA запросу", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 166}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "00b74087-d6d3-4286-99cb-2292502fb2f1", "timestamp": "2025-07-05T03:11:25.005053+05:00", "level": "INFO", "section": "2fa", "subsection": "request_allowed", "message": "Администратор Soldenz РАЗРЕШИЛ вход в систему с IP 85.117.125.216 - предоставляем полный доступ к админ-панели", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 198}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "7228faa8-35bf-414c-a2a4-e9cc11b722c6", "timestamp": "2025-07-05T03:11:25.276236+05:00", "level": "INFO", "section": "security", "subsection": "audit", "message": "Безопасность: Администратор Soldenz успешно прошел 2FA проверку и получил доступ к системе с IP 85.117.125.216 в 22:11:25", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 231}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "65c51b37-c4f3-484c-864b-5166e9ef17b4", "timestamp": "2025-07-05T03:19:10.893061+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA сервис остановлен", "extra_data": {"source_file": "api.py", "source_function": "shutdown_event", "source_line": 66}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "b08ba935-ff6a-43f3-bb2f-cabc762a3380", "timestamp": "2025-07-05T03:19:10.893061+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA микросервис останавливается", "extra_data": {"source_file": "main.py", "source_function": "shutdown_event", "source_line": 71}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "2a140228-4fcc-4e63-a142-a0f1112824a9", "timestamp": "2025-07-05T03:19:10.898407+05:00", "level": "INFO", "section": "system", "subsection": "general", "message": "Connection to amqp://guest:******@localhost:5672/ closed. Reconnecting after 5 seconds.", "extra_data": {"module": "aio_pika.robust_connection"}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "75521e25-8c98-4cde-a0ec-ea6b0a611461", "timestamp": "2025-07-05T03:19:34.819910+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "e49d1607-8b20-43c5-99fd-5039ef8f3316", "timestamp": "2025-07-05T03:19:34.845277+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "a9f53457-80e3-4c8e-a311-10d839a8159b", "timestamp": "2025-07-05T03:19:34.846275+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "8765e31b-528c-41e9-acca-0761423f709b", "timestamp": "2025-07-05T03:19:34.847278+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запускаем Telegram бота для 2FA", "extra_data": {"source_file": "main.py", "source_function": "start_telegram_bot", "source_line": 23}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "c9d05353-aabc-4546-b3c2-31a2a4ee8a23", "timestamp": "2025-07-05T03:20:28.928008+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA сервис остановлен", "extra_data": {"source_file": "api.py", "source_function": "shutdown_event", "source_line": 66}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "f6a14413-433d-4b43-b6c0-113d5af45e62", "timestamp": "2025-07-05T03:20:28.928008+05:00", "level": "INFO", "section": "system", "subsection": "shutdown", "message": "2FA микросервис останавливается", "extra_data": {"source_file": "main.py", "source_function": "shutdown_event", "source_line": 71}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "f1f9255d-41ea-43c7-95f2-1807f2b14c75", "timestamp": "2025-07-05T03:20:58.387296+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запуск 2FA микросервиса на 0.0.0.0:8001", "extra_data": {"source_file": "start.py", "source_function": "main", "source_line": 24}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "bb44923b-4b51-4b7d-b8bd-5f777c46803c", "timestamp": "2025-07-05T03:20:58.406808+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA сервис запущен на 0.0.0.0:8001", "extra_data": {"source_file": "api.py", "source_function": "startup_event", "source_line": 56}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "fd964b58-92db-4a32-85f1-7d30ed64fd1c", "timestamp": "2025-07-05T03:20:58.406808+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "2FA микросервис запускается на 0.0.0.0:8001", "extra_data": {"source_file": "main.py", "source_function": "startup_event", "source_line": 57}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "b94f9441-ba5f-4b7f-9ff3-f9b6ccbb0fda", "timestamp": "2025-07-05T03:20:58.406808+05:00", "level": "INFO", "section": "system", "subsection": "startup", "message": "Запускаем Telegram бота для 2FA", "extra_data": {"source_file": "main.py", "source_function": "start_telegram_bot", "source_line": 23}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "b6e83072-697a-4ade-95d6-efabe51d2b5b", "timestamp": "2025-07-05T03:27:24.858922+05:00", "level": "INFO", "section": "api", "subsection": "request", "message": "Получен запрос на отправку 2FA для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 110}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "d8cb54a9-4283-420e-a436-9776b0f5c06f", "timestamp": "2025-07-05T03:27:24.875054+05:00", "level": "INFO", "section": "2fa", "subsection": "request_sent", "message": "Администратор Омар Амир Арманулы (amiromar.1337@gmail.com) пытается войти в систему с IP 104.28.241.141 - запускаем двухфакторную проверку через Telegram", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 72}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "a2c81362-9c4a-474b-811a-8acfbcce95ce", "timestamp": "2025-07-05T03:27:24.875054+05:00", "level": "DEBUG", "section": "2fa", "subsection": "request_sent", "message": "Создаем временную запись 2FA для Омар Амир Арманулы - срок действия 5 минут (до 22:32:24)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 81}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "56496d56-f828-443e-a6f4-761cf372dde9", "timestamp": "2025-07-05T03:27:24.907347+05:00", "level": "DEBUG", "section": "security", "subsection": "audit", "message": "Ищем откуда подключается пользователь - отправляем запрос геолокации для IP 104.28.241.141", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 31}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "5b1bb7a9-e219-495d-be96-664d9416a62d", "timestamp": "2025-07-05T03:27:25.307681+05:00", "level": "INFO", "section": "security", "subsection": "audit", "message": "Геолокация найдена: IP 104.28.241.141 находится в стране Kazakhstan, город Astana, провайдер Cloudflare, Inc.", "extra_data": {"source_file": "telegram_bot.py", "source_function": "get_location_by_ip", "source_line": 42}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "42ba03a1-4770-45a1-87a9-ea7d517b0cd1", "timestamp": "2025-07-05T03:27:25.622715+05:00", "level": "INFO", "section": "telegram", "subsection": "message_sent", "message": "Уведомление о входе отправлено администратору Омар Амир Арманулы в Telegram (ID: 1172203971) - ожидаем решение о предоставлении доступа с IP 104.28.241.141 (Kazakhstan, Astana)", "extra_data": {"source_file": "telegram_bot.py", "source_function": "send_2fa_request", "source_line": 128}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "57ca5d23-ec3f-4906-861c-93852adc4347", "timestamp": "2025-07-05T03:27:25.624734+05:00", "level": "INFO", "section": "api", "subsection": "response", "message": "2FA запрос успешно отправлен для администратора Омар Амир Арманулы с IP 127.0.0.1", "extra_data": {"source_file": "api.py", "source_function": "send_2fa_request_endpoint", "source_line": 170}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "94287f99-d543-40fa-83e3-7f19509dbcae", "timestamp": "2025-07-05T03:27:36.489852+05:00", "level": "INFO", "section": "telegram", "subsection": "callback_received", "message": "Пользователь Soldenz (@polnokrasoti) нажал кнопку в Telegram - получаем его решение по 2FA запросу", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 166}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "1ff617ec-fe1a-4abb-a0f3-bba3ca14865b", "timestamp": "2025-07-05T03:27:36.500548+05:00", "level": "WARNING", "section": "2fa", "subsection": "request_denied", "message": "Администратор Soldenz ОТКЛОНИЛ попытку входа с IP 104.28.241.141 - блокируем доступ к системе", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 242}, "user_id": null, "ip_address": null, "user_agent": null}
{"log_id": "38757ada-86fe-4e88-af31-2b13b75a7e72", "timestamp": "2025-07-05T03:27:36.762607+05:00", "level": "WARNING", "section": "security", "subsection": "audit", "message": "Безопасность: Попытка входа с IP 104.28.241.141 ЗАБЛОКИРОВАНА! Администратор Soldenz сам отклонил доступ в 22:27:36 - подозрительная активность или несанкционированная попытка входа", "extra_data": {"source_file": "telegram_bot.py", "source_function": "process_2fa_callback", "source_line": 260}, "user_id": null, "ip_address": null, "user_agent": null}
