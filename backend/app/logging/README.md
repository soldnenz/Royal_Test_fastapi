# –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ù–æ–≤–∞—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Royal Test API —Å –µ–¥–∏–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JSON –ª–æ–≥–∏** —Å GMT+5 –≤—Ä–µ–º–µ–Ω–µ–º
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–æ–≥–∞
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª—ã**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è** —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã** –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ª–æ–≥–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–≥–æ–≤ –≤ RabbitMQ** —á–µ—Ä–µ–∑ FastStream –¥–ª—è WARNING, ERROR, CRITICAL

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
app/logging/
‚îú‚îÄ‚îÄ __init__.py              # –≠–∫—Å–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ log_models.py            # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –µ–Ω—É–º—ã
‚îú‚îÄ‚îÄ logger_setup.py          # –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ rabbitmq_handler.py      # RabbitMQ —Ö–µ–Ω–¥–ª–µ—Ä —á–µ—Ä–µ–∑ FastStream
‚îú‚îÄ‚îÄ rabbitmq_example.py      # –ü—Ä–∏–º–µ—Ä—ã RabbitMQ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ utils.py                # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ examples.py             # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# .env —Ñ–∞–π–ª
LOG_LEVEL=INFO                      # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_FILE=logs/application.log       # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ª–æ–≥–æ–≤
SECURITY_LOG_FILE=logs/security.log # –§–∞–π–ª –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
CONSOLE_LOGGING=true                # –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å (true/false)
LOG_MAX_BYTES=10485760             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (10 MB)
LOG_BACKUP_COUNT=5                 # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

# RabbitMQ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
RABBITMQ_LOGGING=true              # –í–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –≤ RabbitMQ (true/false)
RABBITMQ_URL=amqp://guest:guest@localhost:5672/  # URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ
RABBITMQ_EXCHANGE=logs             # –ò–º—è exchange –≤ RabbitMQ
RABBITMQ_ROUTING_KEY=application.logs  # Routing key –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ main.py

```python
from app.logging import setup_application_logging

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
setup_application_logging()
```

## üìù –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from app.logging import get_structured_logger, LogSection
from app.logging.log_models import LogSubsection

# –ü–æ–ª—É—á–∞–µ–º –ª–æ–≥–≥–µ—Ä
logger = get_structured_logger("auth.login")

# –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ
logger.info(
    section=LogSection.AUTH,
    subsection=LogSubsection.AUTH.LOGIN,
    message="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É",
    user_id="507f1f77bcf86cd799439011",
    ip_address="192.168.1.100",
    extra_data={
        "login_method": "email",
        "session_duration": 3600
    }
)
```

## üõ†Ô∏è –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```python
from app.logging.utils import log_auth_event

log_auth_event(
    subsection=LogSubsection.AUTH.LOGIN,
    message="–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ",
    user_id=user_id,
    request=request,
    success=True,
    extra_data={"auth_method": "password"}
)
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```python
from app.logging.utils import log_security_event

log_security_event(
    subsection=LogSubsection.SECURITY.INJECTION_ATTEMPT,
    message="–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏",
    severity="critical",
    request=request,
    threat_data={
        "payload": "'; DROP TABLE users; --",
        "parameter": "username"
    }
)
```

### WebSocket —Å–æ–±—ã—Ç–∏—è

```python
from app.logging.utils import log_websocket_event

log_websocket_event(
    subsection=LogSubsection.WEBSOCKET.CONNECTION,
    message="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ –ª–æ–±–±–∏",
    lobby_id=lobby_id,
    user_id=user_id,
    connection_info={
        "total_connections": 5
    }
)
```

### API –∑–∞–ø—Ä–æ—Å—ã

```python
from app.logging.utils import log_api_request

log_api_request(
    request=request,
    response_status=200,
    processing_time_ms=45.2,
    user_id=user_id
)
```

## üìã –†–∞–∑–¥–µ–ª—ã —Å–∏—Å—Ç–µ–º—ã (LogSection)

- `AUTH` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `ADMIN` - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `WEBSOCKET` - WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `FILES` - –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
- `LOBBY` - –õ–æ–±–±–∏ –∏ –∏–≥—Ä–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏
- `TEST` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ–ø—Ä–æ—Å—ã
- `PAYMENT` - –ü–ª–∞—Ç–µ–∂–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∏
- `SECURITY` - –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `DATABASE` - –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- `SYSTEM` - –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `API` - API –∑–∞–ø—Ä–æ—Å—ã

## üîç –ü–æ–¥—Ä–∞–∑–¥–µ–ª—ã (LogSubsection)

### AUTH
- `LOGIN`, `LOGOUT`, `REGISTRATION`
- `TOKEN_VALIDATION`, `PASSWORD_RESET`, `TWO_FA`

### SECURITY
- `RATE_LIMIT`, `INJECTION_ATTEMPT`
- `UNAUTHORIZED_ACCESS`, `TOKEN_SECURITY`, `AUDIT`

### WEBSOCKET
- `CONNECTION`, `DISCONNECTION`, `MESSAGE`
- `PING_PONG`, `LOBBY_EVENTS`

### FILES
- `UPLOAD`, `DOWNLOAD`, `ACCESS_CHECK`, `VALIDATION`

## üìä –§–æ—Ä–º–∞—Ç –ª–æ–≥–∞

```json
{
    "timestamp": "2024-01-15 14:30:45 +05",
    "log_id": "a7b3c5d1",
    "level": "INFO",
    "section": "auth",
    "subsection": "login",
    "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É",
    "user_id": "507f1f77bcf86cd799439011",
    "ip_address": "192.168.1.100",
    "user_agent": "Mozilla/5.0...",
    "extra_data": {
        "login_method": "email",
        "session_duration": 3600,
        "method": "POST",
        "endpoint": "/auth/login"
    }
}
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ë—ã–ª–æ:
```python
import logging
logger = logging.getLogger(__name__)
logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É")
```

### –°—Ç–∞–ª–æ:
```python
from app.logging import get_structured_logger, LogSection
from app.logging.log_models import LogSubsection

logger = get_structured_logger("auth.login")
logger.info(
    section=LogSection.AUTH,
    subsection=LogSubsection.AUTH.LOGIN,
    message="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É",
    user_id=user_id
)
```

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∞–ª–∏–∞—Å—ã

```python
from app.logging.logger_setup import (
    get_auth_logger,
    get_websocket_logger,
    get_security_logger,
    get_api_logger,
    get_admin_logger
)

# –ë—ã—Å—Ç—Ä–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–æ–≤
auth_logger = get_auth_logger()
ws_logger = get_websocket_logger()
```

## üéØ –î–µ–∫–æ—Äator—ã

```python
from app.logging.utils import log_function_call

@log_function_call(LogSection.TEST, LogSubsection.TEST.VALIDATION)
def validate_test_answers(test_id: str, answers: dict):
    """–§—É–Ω–∫—Ü–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
    # –õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    pass
```

## üìÅ –§–∞–π–ª—ã –ª–æ–≥–æ–≤

- **`logs/application.log`** - –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **`logs/security.log`** - –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (WARNING+ —É—Ä–æ–≤–µ–Ω—å)
- **`logs/application.log.1`** - –ê—Ä—Ö–∏–≤–Ω—ã–µ —Ñ–∞–π–ª—ã (—Ä–æ—Ç–∞—Ü–∏—è)

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏** –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä—ã—Ö `logging.getLogger()`
2. **–£–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ section/subsection** –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
3. **–ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã)
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ extra_data** –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
5. **–°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
6. **–õ–æ–≥–∏ WARNING, ERROR, CRITICAL** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ RabbitMQ

## üê∞ RabbitMQ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏ —É—Ä–æ–≤–Ω—è WARNING, ERROR –∏ CRITICAL –≤ RabbitMQ —á–µ—Ä–µ–∑ FastStream –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RabbitMQ

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ RabbitMQ**:
```bash
# Docker
docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:management

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ
# https://www.rabbitmq.com/download.html
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
```bash
RABBITMQ_LOGGING=true
RABBITMQ_URL=amqp://guest:guest@localhost:5672/
RABBITMQ_EXCHANGE=logs
RABBITMQ_ROUTING_KEY=application.logs
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ RabbitMQ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞:

```python
from app.logging import get_structured_logger, LogSection

logger = get_structured_logger("example")

# –≠—Ç–æ—Ç –ª–æ–≥ –ù–ï –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ RabbitMQ (INFO —É—Ä–æ–≤–µ–Ω—å)
logger.info(
    section=LogSection.SYSTEM,
    subsection="startup",
    message="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ"
)

# –≠—Ç–æ—Ç –ª–æ–≥ –ë–£–î–ï–¢ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ RabbitMQ (WARNING —É—Ä–æ–≤–µ–Ω—å)
logger.warning(
    section=LogSection.API,
    subsection="rate_limit",
    message="–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤",
    extra_data={"user_id": "123", "requests_per_minute": 150}
)

# –≠—Ç–æ—Ç –ª–æ–≥ –ë–£–î–ï–¢ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ RabbitMQ (ERROR —É—Ä–æ–≤–µ–Ω—å)
logger.error(
    section=LogSection.DATABASE,
    subsection="connection",
    message="–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î",
    extra_data={"database": "mongodb", "error": "Connection timeout"}
)
```

### –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—è

```python
from app.logging.rabbitmq_handler import get_rabbitmq_publisher
from app.logging.log_models import StructuredLogEntry, LogLevel, LogSection

# –ü–æ–ª—É—á–∞–µ–º –∏–∑–¥–∞—Ç–µ–ª—è
publisher = get_rabbitmq_publisher()

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥
log_entry = StructuredLogEntry(
    level=LogLevel.ERROR,
    section=LogSection.SECURITY,
    subsection="injection_attempt",
    message="–ü–æ–ø—ã—Ç–∫–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏",
    extra_data={"query": "SELECT * FROM users; DROP TABLE users;"},
    ip_address="10.0.0.1"
)

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ RabbitMQ
success = await publisher.publish_log(log_entry)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ RabbitMQ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å RabbitMQ: `http://localhost:15672`
2. –õ–æ–≥–∏–Ω: `guest`, –ø–∞—Ä–æ–ª—å: `guest`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Exchanges" ‚Üí "logs"
4. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –≤ RabbitMQ

```json
{
    "timestamp": "2024-01-15 14:30:45 +05",
    "log_id": "a7b3c5d1",
    "level": "ERROR",
    "section": "security",
    "subsection": "injection_attempt",
    "message": "–ü–æ–ø—ã—Ç–∫–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏",
    "extra_data": {
        "query": "SELECT * FROM users; DROP TABLE users;",
        "source_file": "auth_router.py",
        "source_function": "login",
        "source_line": 45
    },
    "user_id": null,
    "ip_address": "10.0.0.1",
    "user_agent": null,
    "source": "structured_logger"
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

–°–æ–∑–¥–∞–π—Ç–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–æ–≤:

```python
from faststream import FastStream
from faststream.rabbit import RabbitBroker

app = FastStream(RabbitBroker("amqp://guest:guest@localhost:5672/"))

@app.subscriber("logs", "application.logs")
async def handle_logs(log_data: dict):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ª–æ–≥–æ–≤ –∏–∑ RabbitMQ"""
    print(f"–ü–æ–ª—É—á–µ–Ω –ª–æ–≥: {log_data['level']} - {log_data['message']}")
    
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    if log_data['level'] == 'CRITICAL':
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        pass
    elif log_data['level'] == 'ERROR':
        # –ó–∞–ø–∏—Å–∞—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        pass
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –õ–æ–≥–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `logs/`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `LOG_LEVEL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ
- –£–º–µ–Ω—å—à–∏—Ç–µ `LOG_MAX_BYTES`
- –£–≤–µ–ª–∏—á—å—Ç–µ `LOG_BACKUP_COUNT`

### –ü—Ä–æ–±–ª–µ–º—ã —Å —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `pytz` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –í—Ä–µ–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ GMT+5

### –ü—Ä–æ–±–ª–µ–º—ã —Å RabbitMQ
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ RabbitMQ –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìö –ü—Ä–∏–º–µ—Ä—ã

–°–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª `examples.py` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. 