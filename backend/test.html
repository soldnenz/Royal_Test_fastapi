<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Таймер</title>
  <style>
    body {
      background-color: #171724;
      color: white;
      font-family: 'Arial', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    .container {
      position: relative;
      width: 300px;
      height: 300px;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
    }

    .center-text {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 2;
      text-align: center;
      pointer-events: none;
    }

    .center-text h2 {
      margin: 0;
      font-size: 18px;
      color: white;
    }

    .center-text p {
      margin: 4px 0;
      font-size: 48px;
      font-weight: bold;
      color: white;
      text-shadow:
        0 0 15px rgba(255, 140, 30, 0.3),
        0 0 30px rgba(255, 120, 30, 0.25),
        0 0 60px rgba(255, 100, 0, 0.2);
        0 0 120px rgba(255, 100, 0, 0.1);
    }

    .inputs {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }

    .inputs input {
      padding: 10px;
      border-radius: 5px;
      border: none;
      outline: none;
      font-size: 16px;
      width: 150px;
      text-align: center;
    }

    .inputs button {
      padding: 10px;
      font-size: 16px;
      background: orange;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: black;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="container">
  <canvas id="canvas" width="300" height="300"></canvas>
  <div class="center-text">
    <h2>Осталось</h2>
    <p id="dayCount">0</p>
    <h2>дней</h2>
  </div>
</div>


<div class="inputs">
  <input type="number" id="maxDays" placeholder="Максимум дней" onchange="setMaxDays()">
  <input type="range" id="rangeDays" min="0" value="100" oninput="setLeftDaysFromSlider(this.value)" style="width: 300px;">
</div>
<script>
  let max = 100;
  let left = 100;

  function draw() {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const percent = Math.max(0, Math.min(1, left / max));

    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = 120;

    const rotationDeg = 117;
    const rotationRad = rotationDeg * Math.PI / 180;

    const startAngle = rotationRad;
    const fullArc = Math.PI * 1.7;
    const endAngle = startAngle + fullArc;
    const visibleAngle = startAngle + fullArc * percent;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Пунктирный внутренний круг
    ctx.beginPath();
    for (let i = 0; i < 60; i++) {
      const angle = startAngle + fullArc * (i / 60);
      const dotX = centerX + (radius - 20) * Math.cos(angle);
      const dotY = centerY + (radius - 20) * Math.sin(angle);
      ctx.moveTo(dotX, dotY);
      ctx.arc(dotX, dotY, 1.3, 0, 2 * Math.PI);
    }
    ctx.fillStyle = "#555";
    ctx.fill();

    // Рисуем вручную градиентную дугу по шагам с расчётом цвета
    ctx.lineWidth = 15;
    ctx.lineCap = "round";
    const steps = 200;
    for (let i = 0; i < steps * percent; i++) {
      const t = i / steps;
      const angle1 = startAngle + fullArc * t;
      const angle2 = startAngle + fullArc * (i + 1) / steps;

      let r, g, b;
      if (t < 0.5) {
        const k = t / 0.5;
        r = Math.round(176 + (255 - 176) * k);
        g = Math.round(0 + (140 - 0) * k);
        b = Math.round(32 + (0 - 32) * k);
      } else {
        const k = (t - 0.5) / 0.5;
        r = Math.round(255);
        g = Math.round(140 + (215 - 140) * k);
        b = 0;
      }

      ctx.beginPath();
      ctx.strokeStyle = `rgb(${r},${g},${b})`;
      ctx.arc(centerX, centerY, radius, angle1, angle2);
      ctx.stroke();
    }

    // Оставшаяся часть
    ctx.beginPath();
    ctx.strokeStyle = "#2d2d3a";
    ctx.arc(centerX, centerY, radius, visibleAngle, endAngle);
    ctx.stroke();

    // Белая точка
    const dotX = centerX + radius * Math.cos(visibleAngle);
    const dotY = centerY + radius * Math.sin(visibleAngle);
    ctx.beginPath();
    ctx.fillStyle = "white";
    ctx.arc(dotX, dotY, 2, 0, 2 * Math.PI);
    ctx.fill();

    document.getElementById('dayCount').textContent = left;
    document.getElementById('rangeDays').max = max;
    document.getElementById('rangeDays').value = left;
  }

  function setMaxDays() {
    max = parseInt(document.getElementById('maxDays').value) || 1;
    left = max;
    draw();
  }

  function setLeftDaysFromSlider(value) {
    left = parseInt(value);
    draw();
  }

  window.onload = () => {
    draw();
  };
</script>



</body>
</html>
